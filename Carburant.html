<!doctype html>
<html>
	<head>
		<meta charset="utf8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Conso Carburant</title>
		<style type="text/css">
			:root {
				--header-color: darkslateblue;
				--border-color: grey;
				--container-width: 95rem;
				--remove-row-width: 2rem;
			}

			:root[data-theme="light"] {
				--body-bg-color: unset;
				--header-bg-color: lightblue;
				--section-color: darkslateblue;
				--cell-color: #000011;
				--striped-row-color: #EEEEEE;
				--title-color: #777777;
				--unit-color: #777777;
			}

			:root[data-theme="dark"] {
				--body-bg-color: #212327;
				--header-bg-color: #7eb6d3;
				--section-color: #a3c8db;
				--cell-color: #DDDDDD;
				--striped-row-color: #555555;
				--title-color: #AAAAAA;
				--unit-color: #AAAAAA;
			}

			@media(prefers-color-scheme: dark) {}

			html {
				box-sizing: border-box;
				font-size: clamp(0.7rem, 1.5vw, 1rem);
				/*
				-moz-text-size-adjust: none;
				-webkit-text-size-adjust: none;
				-ms-text-size-adjust: none;
				text-size-adjust: none;
				*/
			}

			*, *:before, *:after {
				box-sizing: inherit;
			}

			body {
				color: var(--cell-color);
				background-color: var(--body-bg-color);
				margin: 0 5px;
				padding: 0 var(--remove-row-width);
			}

			.container {
				margin: 2rem auto;
				max-width: var(--container-width);
			}

			.responsive-table {
				width: 100%;
				margin-bottom: 1.5rem;
				border-spacing: 0;
			}

			.responsive-table thead {
				position: absolute;
				clip: rect(1px 1px 1px 1px);
				/* IE6, IE7 */
				padding: 0;
				border: 0;
				height: 1px;
				width: 1px;
				overflow: hidden;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table thead {
					position: relative;
					clip: auto;
					height: auto;
					width: auto;
					overflow: auto;
				}
			}

			.responsive-table thead th {
				position: sticky;
				top: 0;
				z-index: 1;
				background-color: var(--header-bg-color);
				color: var(--header-color);
				border: 1px solid var(--border-color);
				border-left-color: black;
				border-right-width: 0;
				font-weight: bold;
				text-align: center;
			}

			.responsive-table thead th:first-of-type {
				border-left-color: var(--border-color);
			}

			.responsive-table thead th:last-of-type {
				border-right-width: 1px;
			}

			.responsive-table tbody, .responsive-table tr, .responsive-table th {
				display: block;
				padding: 0;
				white-space: normal;
			}

			.responsive-table td {
				display: flex;
				padding: 0;
				white-space: normal;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tr {
					display: table-row;
				}
			}

			.responsive-table th, .responsive-table td {
				padding: 0.5rem;
				vertical-align: middle;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table th, .responsive-table td {
					display: table-cell;
					padding: 0.5rem;
				}
			}

			.responsive-table caption, .responsive-table tfoot td {
				padding: 0.5rem;
			}

			.responsive-table caption div, .responsive-table tfoot div, .actions {
				display: flex;
				justify-content: space-between;
				gap: 0.625rem;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody {
					display: table-row-group;
				}
			}

			.responsive-table tbody tr {
				margin-bottom: 1rem;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody tr {
					display: table-row;
					border-width: 1px;
				}
			}

			.responsive-table tbody tr:last-of-type {
				margin-bottom: 0;
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody tr:nth-of-type(even) {
					background-color: var(--striped-row-color);
				}
			}

			.responsive-table tbody th[scope="row"] {
				background-color: var(--header-bg-color);
				color: var(--header-color);
			}

			@media screen and (min-width: 16em) {
				.responsive-table tbody th[scope="row"] {
					border-left: 1px solid var(--border-color);
					border-bottom: 1px solid var(--border-color);
				}
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody th[scope="row"] {
					background-color: transparent;
					color: var(--cell-color);
				}
			}

			.responsive-table tbody td {
				justify-content: right;
			}

			.responsive-table tbody td:nth-child(odd) {
				background-color: var(--striped-row-color);
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody td {
					border-left: 1px solid var(--border-color);
					border-bottom: 1px solid var(--border-color);
					text-align: right;
				}

				.responsive-table tbody td:nth-child(odd) {
					background-color: inherit;
				}
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody td:last-of-type {
					border-right: 1px solid var(--border-color);
				}
			}

			.responsive-table tbody td[data-type="text"] {
				text-align: left;
			}

			.responsive-table tbody td[data-title]:before {
				content: attr(data-title);
				margin-right: auto;
				font-size: 0.8rem;
				color: var(--title-color);
			}

			@media screen and (min-width: 16em) {
				.responsive-table tbody td[data-title]:before {
					font-size: 0.9rem;
				}
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody td[data-title]:before {
					content: none;
				}
			}

			.responsive-table tbody tr {
				position: relative;
			}

			.removeRow {
				pointer-events: none;
			}

			.responsive-table tbody tr:has(.editing) .removeRow:before,
			.responsive-table tbody tr:has(.editing) .removeRow:after {
				content: "";
				position: absolute;
				top: 0;
				display: flex;
				height: 100%;
				left: calc(-1 * var(--remove-row-width) - 1px);
				width: var(--remove-row-width);
				justify-content: center;
				align-items: center;
				background-color: #d54242;
				background-image: url("data:image/svg+xml,%3Csvg width='20px' height='20px' viewBox='0 0 1000 1000' xmlns='http://www.w3.org/2000/svg' fill='none' stroke='%23000000' stroke-width='35px'%3E%3Cg stroke-linecap='round' stroke-linejoin='round'%3E%3C/g%3E%3Cg%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bstroke-linecap:round%3Bstroke-miterlimit:10%3B%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M717.37 353.41l-30 390.71a61.19 61.19 0 0 1-61.19 61.19H373.85a61.19 61.19 0 0 1-61.19-61.19l-30-390.71'%3E%3C/path%3E%3Cline class='cls-1' x1='600.9' x2='418.7' y1='314.08' y2='314.08'%3E%3C/line%3E%3Cpath class='cls-1' d='M351.57 314.08H222V276.19a28 28 0 0 1 28-28H438.35c0-.1 0-.19 0-.28 0-29.4 27.61-53.24 61.66-53.24s61.66 23.84 61.66 53.24c0 .09 0 .18 0 .28H750a28 28 0 0 1 28 28v37.89H671.37'%3E%3C/path%3E%3Cline class='cls-1' x1='397.36' x2='397.36' y1='455.63' y2='700.74'%3E%3C/line%3E%3Cline class='cls-1' x1='500' x2='500' y1='455.63' y2='700.74'%3E%3C/line%3E%3Cline class='cls-1' x1='602.64' x2='602.64' y1='455.63' y2='700.74'%3E%3C/line%3E%3C/g%3E%3C/svg%3E");
				background-repeat: no-repeat;
				background-position: center;
				background-size: 1.25rem 1.25rem;
				border-radius: 1.125rem 0.2rem 0.2rem 1.125rem;
				cursor: pointer;
				pointer-events: all;
			}
			.responsive-table tbody tr:has(.editing) .removeRow:after {
				left: unset;
				right: calc(-1 * var(--remove-row-width) - 1px);
				border-radius: 0.2rem 1.125rem 1.125rem 0.2rem;
			}

			.responsive-table tbody tr.error {
				background-color: lightcoral;
			}
			.responsive-table tbody tr.error td[data-field="amount"] {
				background-color: tomato;
			}

			.responsive-table tbody td[data-field="partial"] {
				//background-image: url("https://img.icons8.com/?size=100&id=OdTzdyk9vCvs&format=png&color=23BB3C");
				background-image: url("data:image/png;base64,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");
				background-repeat: no-repeat;
				background-position: right;
				background-size: 2rem 2rem;
				text-align: center;
			}
			.responsive-table tbody td[data-field="partial"].partial {
				//background-image: url("https://img.icons8.com/?size=100&id=OdTzdyk9vCvs&format=png&color=FCC419");
				background-image: url("data:image/png;base64,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");
			}

			@media screen and (min-width: 48em), screen and (orientation: landscape) {
				.responsive-table tbody td[data-field="partial"] {
					background-position: center;
				}
			}

			*[data-unit]:not(:empty):after {
				content:"\A0"attr(data-unit);
				font-size: 0.8rem;
				text-align: left;
				font-style: italic;
				color: var(--unit-color);
			}

			#statContainer {
				display: grid;
				position: relative;
				grid-template-rows: repeat(9, auto);
				grid-template-columns: min-content;
				grid-auto-columns: minmax(max-content, 15em);
				gap: 1px;
				grid-auto-flow: column;
				margin-bottom: 3rem;
				padding-bottom: 0.3rem;
				overflow-x: auto;
			}

			#statContainer > * {
				display: flex;
				padding: 0.5em;
				text-align: right;
				justify-content: right;
				align-items: center;
			}

			#statContainer *:first-child {
				background-color: var(--body-bg-color);
			}

			#statContainer .header {
				display: flex;
				background-color: var(--header-bg-color);
				color: var(--header-color);
				font-weight: bold;
				text-align: center;
				justify-content: center;
				white-space: nowrap;
			}

			#statContainer > *:not(.header):nth-child(9n),
			#statContainer > *:not(.header):nth-child(9n+3),
			#statContainer > *:not(.header):nth-child(9n+5),
			#statContainer > *:not(.header):nth-child(9n+7) {
				background-color: var(--striped-row-color);
			}

			#statContainer > *:nth-child(-n+9) {
				position: sticky;
				left: 0;
				z-index: 1;
			}
			#statContainer > *:not(.header):nth-last-child(-n+8) {
				border-right: solid var(--striped-row-color) 1px;
			}
			#statContainer > *:not(.header):nth-child(9n) {
				border-bottom: solid var(--striped-row-color) 1px;
			}

			.responsive-table thead tr:first-child > *:first-child,
			#statContainer .header:nth-child(2),
			#statContainer .header:nth-child(10) {;
				border-top-left-radius: 0.7rem;
			}
			.responsive-table tbody tr:last-child > *:first-child,
			#statContainer .header:nth-child(9) {
				border-bottom-left-radius: 0.7rem;
			}
			.responsive-table thead tr:first-child > *:last-child,
			#statContainer .header:nth-last-child(9) {
				border-top-right-radius: 0.7rem;
			}
			.responsive-table tbody tr:last-child > *:last-child,
			#statContainer > *:nth-last-child(1) {
				border-bottom-right-radius: 0.7rem;
			}

			h1 {
				text-align: center;
				color: var(--section-color);
			}

			/* BUTTON *//* From Uiverse.io by vinodjangid07 */
			.bookmarkBtn {
				display: flex;
				padding: 0 0.25rem;
				font-weight: bold;
				width: 8.75rem;
				height: 2.5rem;
				border-radius: 2.5rem;
				border: 1px solid rgba(255, 255, 255, 0.349);
				background-color: rgb(10, 195, 21);
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition-duration: 0.3s;
				overflow: hidden;
			}

			.bookmarkBtn:not(:has(.text)) {
				padding: 0;
				width: 2.5rem;
			}

			.bookmarkBtn:disabled {
				pointer-events: none;
				opacity: 0.5;
				filter: grayscale(1);
			}

			.bookmarkBtn:not(:has(.text)) .IconContainer {
				width: 100%;
				height: 100%;
			}

			.bookmarkBtn:not(:has(.text)):hover {
				filter: brightness(1.25);
			}

			.bookmarkBtn .IconContainer {
				display: flex;
				font-size: 1.25rem;
				line-height: 1.25rem;
				width: 2rem;
				height: 2rem;
				background: linear-gradient(to bottom, rgb(16, 131, 166), rgb(7, 71, 86));
				color: white;
				border-radius: 1rem;
				align-items: center;
				justify-content: center;
				overflow: hidden;
				z-index: 2;
				transition-duration: 0.3s;
			}

			.bookmarkBtn svg {
				width: 1.125rem;
				height: 1.125rem;
			}

			.bookmarkBtn .text {
				display: flex;
				font-size: 0.8rem;
				height: 100%;
				flex-grow: 1;
				align-items: center;
				justify-content: center;
				color: darkslateblue;
				z-index: 1;
				transition-duration: 0.3s;
				white-space: nowrap;
			}

			.bookmarkBtn:hover .IconContainer {
				width: 100%;
				transition-duration: 0.3s;
			}

			.bookmarkBtn:hover .text {
				transform: translate(1rem);
				width: 0;
				font-size: 0;
				transition-duration: 0.1s;
			}

			.bookmarkBtn:active {
				transform: scale(0.95);
				transition-duration: 0.3s;
			}
		</style>
		<!--
		<script type="text/javascript" src="/utils/javascript/Loader.js" data-load="4"></script>
		<script type="text/javascript" data-drive="/I:">if (typeof _jsUtilsLoader === "undefined") document.write(document.querySelector("script[data-load]")?.outerHTML.replace(/(?<=src=(["']))(?:\/\w:(?=\/))?([^\1]+)/, document.currentScript.dataset.drive + "$2"));</script>
		-->
		<script type="text/javascript">
			(() => {
				const selectMode = (e) => document.documentElement.dataset.theme = e.matches ? "dark" : "light";
				const matchDarkScheme = window.matchMedia?.("(prefers-color-scheme: dark)");
				selectMode(matchDarkScheme);
				matchDarkScheme?.addEventListener("change", selectMode);

				const preferedMode = new URLSearchParams(window.location.search).get("theme");
				if (["dark", "light"].includes(preferedMode)) {
					selectMode({matches: "dark" === preferedMode});
				}
			})();
		</script>
		<script type="text/javascript" src="Carburant.json"></script>
		<script type="text/javascript">
			const savedFields = ["date", "km", "price", "quantity", "amount", "location", "partial", "comment"];
			const filledRowFields = savedFields.slice(0, savedFields.indexOf("amount") + 1);
			const emptyRowFields = filledRowFields.slice(1);
			const mapping = {};

			const dayInMs = 1000 * 60 * 60 * 24, daysInMonth = 30.4375, daysInYear = 365.25;

			let headers, lastEditableHeader;
			const dateFormat = (d) => (d ?? new Date()).toLocaleDateString("fr-FR");
			const zeroDigitFormat = new Intl.NumberFormat("fr-FR", {maximumFractionDigits: 0});
			const twoDigitFormat = new Intl.NumberFormat("fr-FR", {minimumFractionDigits: 2, maximumFractionDigits: 2});
			const threeDigitFormat = new Intl.NumberFormat("fr-FR", {minimumFractionDigits: 3, maximumFractionDigits: 3});
			const format = {
				of(rowData, field) {
					return this[field]?.(rowData[field]) ?? rowData[field] ?? "";
				},
				km: (fieldData) => apply(zeroDigitFormat.format, fieldData),
				price: (fieldData) => apply(threeDigitFormat.format, fieldData),
				quantity: (fieldData) => apply(twoDigitFormat.format, fieldData),
				amount: (fieldData) => apply(twoDigitFormat.format, fieldData),
				distance: (fieldData) => apply(zeroDigitFormat.format, fieldData),
				consumption: (fieldData) => apply(twoDigitFormat.format, fieldData),
				duration: (fieldData) => apply(zeroDigitFormat.format, fieldData),
				partial: () => "",
			};

			const attributes = {
				of(field, rowData) {
					const atts = [];
					atts.push(`id="${getRowFieldId(rowData.id, field)}"`);
					if (savedFields.includes(field)) {
						atts.push('contenteditable="true"');
					}
					this[field]?.(atts, rowData?.[field]);
					return atts.join(' ');
				},
				km: (atts) => atts.push('data-unit="km"'),
				price: (atts) => atts.push('data-unit="€"'),
				quantity: (atts) => atts.push('data-unit="L"'),
				amount: (atts) => atts.push('data-unit="€"'),
				location: (atts) => atts.push('data-type="text"'),
				distance: (atts) => atts.push('data-unit="km"'),
				consumption: (atts) => atts.push('data-unit="L/100km"'),
				duration: (atts) => atts.push('data-unit="j"'),
				partial: (atts, fieldData) => { if (fieldData) { atts.push('class="partial"') } }
			};

			const actions = {
				index: 0,
				savedIndex: 0,
				history: [],
				addAction(action) {
					this.history.splice(this.index++, this.history.length + 1 - this.index, action);
					action.toString = () => JSON.stringify(action);
					if (this.index <= this.savedIndex) {
						this.savedIndex = null;
					}
					this.updateButtons();
					console.log(`index: ${this.index}, savedIndex: ${this.savedIndex}, unsavedState: ${this.unsavedState()}`);
					console.log(`action added : '${action}' at index ${this.index}, history : ['${this.history.join("', '")}']`);
				},
				undo() {
					if (this.index > 0) {
						const action = this.history[--this.index];
						this.updateButtons();
						console.log(`revert action : '${action}', current index : ${this.index}, history : ['${this.history.join("', '")}']`);
						if (action?.rowData) {
							this.updateField(action.rowData, action.field, action.oldValue, true);
						} else if (action?.addedRowData) {
							this.removeRow(action.addedRowData, true);
						} else if (action?.removedRowData) {
							this.addRow(action.removedRowData);
						}
					}
				},
				redo() {
					if (this.index < this.history.length) {
						const action = this.history[this.index++];
						this.updateButtons();
						console.log(`redo action : '${action}', current index : ${this.index}, history : ['${this.history.join("', '")}']`);
						if (action?.rowData) {
							this.updateField(action.rowData, action.field, action.newValue, true);
						} else if (action?.addedRowData) {
							this.addRow(action.addedRowData);
						} else if (action?.removedRowData) {
							this.removeRow(action.removedRowData, true);
						}
					}
				},
				save() {
					console.log("TO BE IMPLEMENTED");
					this.savedIndex = this.index;
					this.updateButtons();
				},
				unsavedState() {
					return (this.savedIndex === null) || (this.savedIndex !== this.index);
				},
				updateButtons() {
					[...document.querySelectorAll(".undo")].forEach(e => e.disabled = this.index === 0);
					[...document.querySelectorAll(".redo")].forEach(e => e.disabled = this.index === this.history.length);
					[...document.querySelectorAll(".save")].forEach(e => e.disabled = !this.unsavedState());
				},
				addEventListeners() {
					window.addEventListener("keydown", (event) => {
						const key = event.key.toUpperCase();
						const ctrl = event.ctrlKey || event.metaKey;
						if (!event.defaultPrevented && ctrl && ["S", "Y", "Z"].includes(key)) {
							event.preventDefault();
							event.stopPropagation();
							switch(key) {
								case "S":
									this.save();
									break;
								case "Y":
									this.redo();
									break;
								case "Z":
									this[event.shiftKey ? "redo" : "undo"]();
									break;
							}
						}
					});
				},
				updateField(rowData, field, newValue, fromHistory) {
					if (!fromHistory) {
						this.addAction({ rowData: rowData, field: field, oldValue: rowData[field], newValue: newValue });
					}
					rowData[field] = newValue;
					if (fromHistory) {
						document.getElementById(getRowFieldId(rowData.id, field)).textContent = format.of(rowData, field);
					}
					processChanges(rowData, field === "partial");
				},
				addRow(historyRowData) {
					const rowData = historyRowData ?? {};
					const nextRowData = mapping[rowData.id];
					let index = rowData?.index;
					if (historyRowData) {
						console.log("Before Add Row, Array=\n", dataArray.map(({id, index}) => `${id}, ${index}`).join("\n"), "\nmapping=\n", Object.keys(mapping));
						dataArray.splice(rowData.index, 0, rowData);
						let fixIndex = dataArray.length-1;
						dataArray.filter((d, i) => i > rowData.index).reverse().forEach(d => this.fixRowDataIndex(d, fixIndex--));
					} else {
						rowData.date = dateFormat();
						index = dataArray.push(rowData)-1;
					}

					const tbody = document.querySelector("#dataTable tbody");
					tbody.insertAdjacentHTML('beforeend', createRow(headers, rowData, index));
					[...document.querySelectorAll('#dataTable tr:last-of-type *[contenteditable="true"]')].forEach(elem => addEventListeners(elem));
					addRemoveRowElems();

					if (!historyRowData) {
						this.addAction({ addedRowData: rowData });
						document.getElementById(getRowFieldId(rowData.id, "date"))?.focus();
					} else if (nextRowData) {
						tbody.insertBefore(tbody.lastElementChild, document.getElementById(nextRowData.id));
						console.log("After Add Row, Array=\n", dataArray.map(({id, index}) => `${id}, ${index}`).join("\n"), "\nmapping=\n", Object.keys(mapping));
					} else {
						console.log("After Add Row, Array=\n", dataArray.map(({id, index}) => `${id}, ${index}`).join("\n"), "\nmapping=\n", Object.keys(mapping));
					}
					processChanges(getRowData(rowData.id), true);
				},
				removeRow(rowData, fromHistory) {
					if (fromHistory || isEmptyRowData(rowData) || window.confirm("Supprimer cette ligne provoquera une incohérence dans les lignes qui suivent.\n\nSouhaitez-vous vraiment la supprimer ?")) {
						if (!fromHistory) {
							this.addAction({ removedRowData: rowData });
						}
						const elem = document.getElementById(rowData.id);
						elem?.parentElement.removeChild(elem);
						dataArray.splice(rowData.index, 1);
						delete mapping[rowData.id];
						if (rowData.index !== dataArray.length) {
							let fixIndex = rowData.index;
							dataArray.filter((d, i) => i >= rowData.index).forEach(d => this.fixRowDataIndex(d, fixIndex++));
						}
						processChanges(getRowData(rowData.id));
					}
				},
				fixRowDataIndex(rowData, newIndex) {
					const oldRowId = rowData.id, oldRowIndex = rowData.index;

					rowData.id = getRowId(newIndex);
					rowData.index = newIndex;

					delete mapping[oldRowId];
					mapping[rowData.id] = rowData;

					[...document.querySelectorAll(`*[id|="${oldRowId}"]`)].forEach(e => {
						const field = e.dataset.field;
						e.setAttribute("id", field ? getRowFieldId(rowData.id, field) : rowData.id);
					});
				},
			};

			function apply(func, ...args) {
				return args.some(a => a === undefined) ? undefined : func.apply(null, args);
			}

			function dateToMS(d) {
				return apply(Date.UTC, ...(d?.split("/").reverse().map((n, i) => Number(n) - (i === 1 ? 1 : 0)) ?? [undefined]));
			}

			function getYear(d) {
				return d?.substr(-4);
			}

			function autocompleteDate(date, prevRowDate) {
				const refDate = prevRowDate ? new Date(dateToMS(prevRowDate)) : new Date();
				let [_, d, m, y] = date.match(/^\s*(\d{1,2})\D?(\d{1,2})?\D?(\d{2}|\d{4})?\s*$/);
				const refD = refDate[`get${prevRowDate?"UTC":""}Date`](), refM = refDate[`get${prevRowDate?"UTC":""}Month`](), refY = refDate[`get${prevRowDate?"UTC":""}FullYear`]();
				const dir = prevRowDate ? -1 : 1;

				d = Number(d);
				if (prevRowDate) {
					m = m ? Number(m) - 1 : (12 + refM + (d <= refD ? 1 : 0)) % 12;
					y = y ? Number(y) : refY + (m < refM ? 1 : (m === refM && d < refD) ? 1 : 0);
				} else {
					m = m ? Number(m) - 1 : (12 + refM - (d > refD ? 1 : 0)) % 12;
					y = y ? Number(y) : refY - (m > refM ? 1 : (m === refM && d > refD) ? 1 : 0);
				}
				y = y < 100 ? Math.trunc(new Date().getFullYear() / 100) * 100 + y : y;

				return dateFormat(new Date(y, m, d));
			}

			function isEmptyRowData(rowData) {
				return emptyRowFields.every(f => !rowData[f]);
			}

			function isFilledRowData(rowData) {
				return filledRowFields.every(f => rowData[f]);
			}

			function saveDataArray() {
				const sanitized = dataArray.filter(d => !isEmptyRowData(d)).map(rowData => savedFields.reduce((o, f) => (o[f] = rowData[f], o), {}));
				console.log(JSON.stringify(sanitized, undefined, "\t").replace(/[\r\n]+\t(?:\t+|(?=}))/g,""));
			}

			function getField(elem) {
				return elem.getAttribute("data-field");
			}

			function getRowData(elemId) {
				return mapping[elemId.replace(/^(\w\d+)(?:\D.*)?$/, "$1")];
			}

			function adjacentRowFieldId(currentId, rowIncrement) {
				return currentId.replace(/(\w)(\d+)/, (m, l, n) => l + (Number(n) + rowIncrement));
			}

			function adjacentRowData(currentRowData, rowIncrement) {
				return mapping[currentRowData.id.replace(/(\w)(\d+)/, (m, l, n) => l + (Number(n) + rowIncrement))];
			}

			function getRowId(index) {
				return "r" + index;
			}

			function getRowFieldId(rowId, field) {
				return rowId + "-" + field;
			}

			function expandData(dataArray, rowData, i) {
				const update = rowData.id;

				rowData.dateInMs = dateToMS(rowData.date);
				rowData.distance = apply((current, prev) => current - prev, rowData.km, dataArray[i-1]?.km);
				rowData.duration = apply((current, prev) => (current - prev) / dayInMs, rowData.dateInMs, dataArray[i-1]?.dateInMs);

				rowData.consumption = undefined;
				if (!rowData.partial) {
					let start = dataArray[i-1]?.km, quantity = rowData.quantity, j = i;
					while(!isNaN(quantity) && dataArray[--j]?.partial) {
						start = dataArray[j-1]?.km;
						quantity += dataArray[j].quantity;
					}
					rowData.consumption = apply((q, currD, prevD) => q * 100 / (currD - prevD), quantity || undefined, rowData.km, start);
				}

				rowData.error = apply((p, q, a) => {
						const r = Math.round(p*q*100);
						return (r === Math.round(a*100)) ? undefined : "attendu : " + twoDigitFormat.format(r/100) + " €";
					},
					rowData.price, rowData.quantity, rowData.amount
				);

				if (update) {
					console.log("updating data", rowData.id);
					const dynamicFields = ["distance", "duration", "consumption"];
					const rowElem = document.getElementById(rowData.id);
					rowElem?.classList[rowData.error ? "add" : "remove"]("error");
					rowElem?.[(rowData.error ? "set" : "remove")+"Attribute"]("title", rowData.error);
					rowElem?.querySelectorAll(dynamicFields.map(f => "#"+getRowFieldId(rowData.id, f)).join(",")).forEach(elem => {
						elem.textContent = format.of(rowData, getField(elem));
					});
				}
			}

			function addRemoveRowElems() {
				const containers = document.querySelectorAll(":nth-child(1 of .responsive-table tbody td:not([contenteditable])):not(:has(.removeRow))");
				[...containers].forEach(e => {
					const attrs = [...e.attributes].filter(({name}) => name !== "data-title").map(({name, value}) => (e.removeAttribute(name), `${name}="${value}"`)).join(" ");
					e.insertAdjacentHTML('beforeend', `<span ${attrs}>${e.textContent}</span>`);
					e.insertAdjacentHTML('beforeend', `<span class="removeRow" onmousedown="actions.removeRow(getRowData(this.parentElement.parentElement.id))" title="Supprimer la ligne"></span>`);
					e.firstChild.data = "";
				});
			}

			function createRow(headers, rowData, index) {
				rowData.id = getRowId(index);
				rowData.index = index;
				mapping[rowData.id] = rowData;
				return `<tr id=${getRowId(index)} ${rowData.error ? `class="error" title="${rowData.error}"` : ''}>`
					+ headers.map((h, i) => `<${i === 0 ? 'th scope="row"' : 'td'} data-title="${h.title}" data-field="${h.field}" ${attributes.of(h.field, rowData)}>${format.of(rowData, h.field)}</${i === 0 ? 'th' : 'td'}>`).join('')
					+ "</tr>";
			}

			function createTable() {
				headers = [...document.querySelectorAll("#dataTable thead th")].map(h => ({title: h.textContent, field: getField(h)}));
				lastEditableHeader = headers.map(h => h.field).findLast(f => savedFields.includes(f));

				const addLineButton = '<button class="bookmarkBtn" onclick="actions.addRow()"><span class="IconContainer">+</span><p class="text">Nouvelle ligne</p></button>';
				const undoButton = '<button disabled class="bookmarkBtn undo" title="Annuler" onclick="actions.undo()"><span class="IconContainer"><svg viewBox="0 0 24 24" height="18" width="18" fill="none" stroke="#ffffff" stroke-width="2" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round"></g><g> <g> <path d="M10 8H5V3M5.29102 16.3569C6.22284 17.7918 7.59014 18.8902 9.19218 19.4907C10.7942 20.0913 12.547 20.1624 14.1925 19.6937C15.8379 19.225 17.2893 18.2413 18.3344 16.8867C19.3795 15.5321 19.963 13.878 19.9989 12.1675C20.0347 10.4569 19.5211 8.78001 18.5337 7.38281C17.5462 5.98561 16.1366 4.942 14.5122 4.40479C12.8878 3.86757 11.1341 3.86499 9.5083 4.39795C7.88252 4.93091 6.47059 5.97095 5.47949 7.36556" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg></span></button>';
				const redoButton = '<button disabled class="bookmarkBtn redo" title="Répéter" onclick="actions.redo()"><span class="IconContainer"><svg viewBox="0 0 24 24" height="18" width="18" fill="none" stroke="#ffffff" stroke-width="2" xmlns="http://www.w3.org/2000/svg"><g stroke-linecap="round" stroke-linejoin="round"></g><g> <g> <path d="M13.9998 8H18.9998V3M18.7091 16.3569C17.7772 17.7918 16.4099 18.8902 14.8079 19.4907C13.2059 20.0913 11.4534 20.1624 9.80791 19.6937C8.16246 19.225 6.71091 18.2413 5.66582 16.8867C4.62073 15.5321 4.03759 13.878 4.00176 12.1675C3.96593 10.4569 4.47903 8.78001 5.46648 7.38281C6.45392 5.98561 7.86334 4.942 9.48772 4.40479C11.1121 3.86757 12.8661 3.86499 14.4919 4.39795C16.1177 4.93091 17.5298 5.97095 18.5209 7.36556" stroke-linecap="round" stroke-linejoin="round"></path> </g> </g></svg></span></button>';
				const saveButton = '<button disabled class="bookmarkBtn save" onclick="actions.save()"><span class="IconContainer"><svg viewBox="0 0 256 256" height="18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="M74.34 85.66a8 8 0 0 1 11.32-11.32L120 108.69V24a8 8 0 0 1 16 0v84.69l34.34-34.35a8 8 0 0 1 11.32 11.32l-48 48a8 8 0 0 1-11.32 0ZM240 136v64a16 16 0 0 1-16 16H32a16 16 0 0 1-16-16v-64a16 16 0 0 1 16-16h52.4a4 4 0 0 1 2.83 1.17L111 145a24 24 0 0 0 34 0l23.8-23.8a4 4 0 0 1 2.8-1.2H224a16 16 0 0 1 16 16m-40 32a12 12 0 1 0-12 12a12 12 0 0 0 12-12" fill="currentColor"></path></svg></span><p class="text">Enregistrer</p></button>';
				[...document.querySelectorAll("#dataTable caption, #dataTable tfoot td")].forEach(e => {
					if ("td" === e.nodeName.toLowerCase()) {
						e.setAttribute("colspan", headers.length);
					}
					e.firstElementChild.insertAdjacentHTML('beforeend', addLineButton);
					e.firstElementChild.insertAdjacentHTML('beforeend', '<span class="actions">'+undoButton+redoButton+saveButton+'</span>');
				});

				const tbody = document.querySelector("#dataTable tbody");
				dataArray.forEach((rowData, i) => {
					expandData(dataArray, rowData, i);
					tbody.insertAdjacentHTML('beforeend', createRow(headers, rowData, i));
				});
				[...document.querySelectorAll('*[contenteditable="true"]')].forEach(elem => addEventListeners(elem));
				addRemoveRowElems();
			}

			const eventListeners = {
				onfocus: (event) => {
					cellData(event.target);
					window.getSelection().selectAllChildren(event.target);
				},
				onblur: (event) => {
					cellData(event.target, event.target.textContent);
				},
				onkeydown: (event) => {
					const key = event.key.toUpperCase();
					const ctrl = event.ctrlKey || event.metaKey;
					const elem = event.target;
					const rowData = getRowData(elem.id);
					const field = getField(elem);
					const partialElem = field === "partial";
					const isLast = dataArray.length - 1 === rowData.index;
					if (!event.defaultPrevented && ctrl && ["Y", "Z"].includes(key)) {
						const modified = (elem.textContent !== String(elem.oldValue));
						const stopPropagation = modified ? ("Z" === key && !event.shiftKey) : ("Y" === key || event.shiftKey);
						if (stopPropagation) {
							event.stopPropagation();
						}
					}
					if (isLast && !event.defaultPrevented && (("ArrowDown" === event.key) || ((field === lastEditableHeader) && ("Tab" === event.key)))) {
						event.preventDefault();
						addRow();
					} else if (!event.defaultPrevented && (["Enter", "Escape", "ArrowDown", "ArrowUp"].includes(event.key) || ((event.code === "Space") && partialElem))) {
						event.preventDefault();
						if (["ArrowDown", "ArrowUp"].includes(event.key)) {
							const target = document.getElementById(adjacentRowFieldId(elem.id, event.key === "ArrowUp" ? -1 : 1));
							target?.focus();
						} else {
							if (event.code === "Space") {
								elem.classList.toggle("partial");
							} else if (event.key === "Escape") {
								if (partialElem) {
									elem.classList[elem.oldValue ? "add" : "remove"]("partial");
								} else {
									elem.textContent = elem.oldValue;
									if (isEmptyRowData(rowData)) {
										actions.removeRow(rowData);
									}
								}
							}
							elem.blur();
							window.getSelection().removeAllRanges();
						}
					}
				},
				onmousedown: (event) => {
					const elem = event.target;
					if (elem.classList.contains("editing") && getField(elem) === "partial") {
						event.preventDefault();
						elem.classList.toggle("partial");
						elem.blur();
						window.getSelection().removeAllRanges();
					}
				},
			};
			function addEventListeners(elem) {
				Object.entries(eventListeners).forEach(([ev, func]) => elem[ev] = func);
			}

			function cellData(elem, newValue) {
				/* Autocomplete on contenteditable
https://medium.com/naukri-engineering/unlocking-rich-text-editing-with-htmls-contenteditable-attribute-a-developer-s-guide-81a63a0e0b46
https://jsfiddle.net/4Lmfn3qo/
				*/
				const rowData = getRowData(elem.id);
				const field = getField(elem);
				let curVal = rowData[field];
				elem.oldValue = curVal;
				elem.classList.add("editing");

				if (newValue !== undefined) {
					newValue = newValue === '' ? undefined : newValue;
					const numericFields = ["km", "price", "quantity", "amount"];
					if (field === "partial") {
						newValue = elem.classList.contains("partial") ? true : undefined;
					} else if (numericFields.includes(field)) {
						newValue = isNaN(Number(newValue)) ? curVal : Number(newValue);
					} else if (field === "date") {
						newValue = autocompleteDate(newValue, adjacentRowData(rowData, -1)?.date);
					}
					if (newValue !== curVal) {
						actions.updateField(rowData, field, newValue);
					}
					elem.textContent = format.of(rowData, field);
					elem.classList.remove("editing");
				} else if (field !== "partial") {
					elem.textContent = curVal;
				}
			}

			function processChanges(rowData, partialChanged) {
				if (partialChanged) {
					let targetRowData = rowData;
					do {
						targetRowData = adjacentRowData(targetRowData, 1);
						processChanges(targetRowData);
					} while(targetRowData?.partial);
				}
				if (rowData) {
					expandData(dataArray, rowData, rowData.index);
					if (!rowData.partial) {
						generateStats();
					}
				}
			}

			const stats = {
				"span": { calc: ({year}) => year || "global" },
				"consommation": {
					unit: "L/100km",
					calc: ({list, kms}) => twoDigitFormat.format(list.reduce((sum, {quantity}, i) => sum + (i === 0 ? 0 : quantity), 0) * 100 / kms)
				},
				"périodicité": {
					unit: "j",
					calc: ({list}) => zeroDigitFormat.format(list.reduce((sum, {duration}, i) => sum + (i === 0 ? 0 : duration), 0) / (list.length - 1))
				},
				"périodicité médiane": {
					unit: "j",
					calc: ({list}) => zeroDigitFormat.format([...list].sort(({duration:d1}, {duration:d2}) => d1 - d2)[Math.trunc(list.length/2)]?.duration)
				},
				"trajet annuel": {
					unit: "km/an",
					calc: ({kms, days, year}) => zeroDigitFormat.format(year ? kms : kms * daysInYear / days)
				},
				"trajet mensuel": {
					unit: "km/mois",
					calc: ({kms, days}) => zeroDigitFormat.format(kms * daysInMonth / days)
				},
				"coût annuel": {
					unit: "€/an",
					calc: ({list, cost, days, year}) => twoDigitFormat.format(year ? cost + (getYear(list[0].date) === year ? list[0].amount : 0) : cost * daysInYear / days)
				},
				"coût mensuel": {
					unit: "€/mois",
					calc: ({cost, days}) => twoDigitFormat.format(cost * daysInMonth / days)
				},
				"coût aux 100km": {
					unit: "€/100km",
					calc: ({cost, kms}) => twoDigitFormat.format(cost * 100 / kms)
				},
			};

			function applyStats(statCont, year) {
				const list = dataArray.filter((rowData, i) => isFilledRowData(rowData) && (!year || getYear(rowData.date) === year || getYear(dataArray[i+1]?.date) === year));
				if (list.length < 2) {
					return;
				}
				const kmList = list.map(rowData => rowData.km);
				const dateList = list.map(rowData => rowData.dateInMs);
				const statData = {
					list: list,
					year: year,
					kms: Math.max(...kmList) - Math.min(...kmList),
					days: (Math.max(...dateList) - Math.min(...dateList)) / dayInMs,
					cost: list.reduce((sum, {amount}, i) => sum + (i === 0 ? 0 : amount), 0),
				}
				Object.values(stats).forEach(({unit, calc}, i) => statContainer.insertAdjacentHTML('beforeend', `<div class="${i === 0 ? 'header' : ''}" data-unit="${unit??''}">${calc?.(statData)}</div>`));
			}

			function generateStats() {
				const statCont = document.getElementById("statContainer");
				while (statCont?.firstChild) {
					statCont.removeChild(statCont.lastChild);
				}
				const years = Object.keys( dataArray.reduce((rowData, {date}) => (rowData[getYear(date)] = true, rowData), {"": true}) );
				Object.keys(stats).forEach((header, i) => statContainer.insertAdjacentHTML('beforeend', `<div class="${i === 0 ? '' : 'header'}">${i === 0 ? "" : header}</div>`));
				years.sort();
				years.forEach(year => applyStats(statCont, year));
			}

			function populate() {
				actions.addEventListeners();
				createTable();
				generateStats();
			}
		</script>
	</head>
	<body onload="populate()">
		<div class="container">
			<h1>Statistiques</h1>
			<div id="statContainer"></div>

			<h1>Consommation de carburant</h1>
			<div class="table-container">
				<table id="dataTable" class="responsive-table">
					<caption><div></div></caption>
					<thead>
						<tr>
							<th scope="col" data-field="date">Date</th>
							<th scope="col" data-field="km">Kilométrage</th>
							<th scope="col" data-field="price">Prix au litre</th>
							<th scope="col" data-field="quantity">Quantité</th>
							<th scope="col" data-field="amount">Montant</th>
							<th scope="col" data-field="location">Provenance</th>
							<th scope="col" data-field="distance">Distance</th>
							<th scope="col" data-field="consumption">Consommation</th>
							<th scope="col" data-field="duration">Délai</th>
							<th scope="col" data-field="partial">Plein</th>
							<th scope="col" data-field="comment">Commentaire</th>
						</tr>
					</thead>
					<tfoot><tr><td><div></div></td></tr></tfoot>
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
	</body>
</html>
